buildscript{
	repositories{
		jcenter()
	}
	
	dependencies{
		classpath "org.asciidoctor:asciidoctor-gradle-plugin:1.5.2"
		classpath "commons-httpclient:commons-httpclient:3.1"
		classpath "com.github.houbie:lesscss-gradle-plugin:1.0.3-less-1.7.0"
	}
}

apply plugin: "lesscss"
apply plugin: "org.asciidoctor.gradle.asciidoctor"
import org.asciidoctor.gradle.AsciidoctorTask

ext{
	frameworkDir = new File( "src/framework" )
	templateDir = new File( frameworkDir, "asciidoctor-deck.js/templates")
	deckjsDir = new File( frameworkDir, "deck.js")
	buildDeckjsDir = new File( frameworkDir, "asciidoc/deckjs/deck.js/extensions")
}

lessc{
	sourceDir "${deckjsDir}/themes/style"
	include "**/*.less"
	destinationDir = "${buildDeckjsDir}/../themes/style"
	mustRunAfter project.tasks.getByName("asciidoctor")
}

task presentation( type: AsciidoctorTask){
	logDocuments = true
	sourceDir "src/asciidoc"
	
	sources{
		include "slides.adoc"
	}
	
	backends "deckjs"

	options template_dirs: [new File( templateDir, "haml").absolutePath]
	options eruby:'erubis'
	
	attributes "source-highlighter": "coderay"
	attributes idprefix: ""
	attributes idseparator: "-"
	
	resources{
		from( sourceDir){
			include "images/**"
		}
		
		from( frameworkDir){
			include "deck.js/**"
		}
	}
	
	description = "Builds the HTML5 Presentation"
}